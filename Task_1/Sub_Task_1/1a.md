# Subtask 1a - Coverage Analysis

## Objective

In this subtask, we will perform a coverage analysis on a dataset containing phased methylation patterns (PMPs) across different tissue types. Specifically, it calculates the single CpG coverage for each sample and computes the median and coefficient of variation (CV) for the coverage of CpG sites in various tissue types.



---

## Data Overview

The data used in this analysis is stored in the `PupilBioTest_PMP_revA_task1.csv` file, which contains the following columns:

- `Tissue`: Tissue type (Tissue #1 or Tissue #2).
- `CpG_Coordinates`: The coordinates of the CpG sites.
- `Strand` : Indicates the DNA strand (‘f’ or ‘r’).
- `Methylation Status` : Eight possible patterns (‘000’ to ‘111’).
- `Sample ID` : Unique identifier for each sample.
- `Replicate` : Indicates technical replicates. 

## Approach
1. Load the necessary libraries in R
2. Loading the dataset
3. Inspecting the dataset
4. Checking column names
5. Calculating the single CpG coverage
6. Grouping Data by Tissue Type and Calculating Statistics
7. Output


## Code Implementation

This R code demonstrates how to load the data, calculate the Single CpG coverage, and compute the median and CV for each tissue.

```r
# Load necessary library
library(dplyr)

# Load the dataset from a CSV file
methylation_data <- read.csv("PupilBioTest_PMP_revA.csv")

# Check the first few rows of the dataset to confirm it's loaded correctly
G#head(methylation_data)

# Check the column names to ensure correct references
colnames(methylation_data)

# Calculate the total coverage for each row (sum of methylation columns)
methylation_data$Single_CpG_Coverage <- rowSums(methylation_data[, c('X.000', 'X.001', 'X.010', 'X.011', 'X.100', 'X.101', 'X.110', 'X.111')])

# Group by tissue type and calculate the median and CV of single CpG coverage
coverage_stats <- methylation_data %>%
  group_by(Tissue) %>%
  summarise(
    Median_CpG_Coverage = median(Single_CpG_Coverage),
    CV_CpG_Coverage = (sd(Single_CpG_Coverage) / mean(Single_CpG_Coverage)) * 100
  )

# Print the results
print(coverage_stats)

```

## Ouput

The output from the above R code will be a table summarizing the median coverage and CV for each tissue, as shown below:
| Tissue   | Median_CpG_Coverage | CV_CpG_Coverage   |
|----------|--------|------|
| Islet    | 84    | 114 |
| cfDNA    | 484   | 132 |
 
